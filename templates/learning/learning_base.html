<!-- templates/learning/learning_base.html -->
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}IGCSE Learning Platform{% endblock %}</title>

    <!-- Local Tailwind -->
    <link rel="stylesheet" href="{% static 'css/tailwind.css' %}">
    <!-- Educator dashboard overrides -->
    <link rel="stylesheet" href="{% static 'css/educator_dashboard.css' %}">
    
    {% block extra_head %}{% endblock %}
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- ---------------- Navbar ---------------- -->
    <nav class="module-navbar bg-white shadow-md rounded-md">
        <div class="container mx-auto flex justify-between items-center p-4">
            
            <!-- Brand / Dashboard Link -->
            <a href="{% url 'cam_igcse:dashboard' %}" class="nav-brand font-bold text-blue-700 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                </svg>
                IGCSE Dashboard
            </a>

            <!-- Burger for Mobile -->
            <div class="burger md:hidden flex flex-col gap-1 cursor-pointer">
                <div class="w-6 h-0.5 bg-gray-700"></div>
                <div class="w-6 h-0.5 bg-gray-700"></div>
                <div class="w-6 h-0.5 bg-gray-700"></div>
            </div>

            <!-- Nav Links -->
            <ul class="nav-links hidden md:flex gap-4">
                {% for m in all_modules %}
                    <li class="nav-item relative group">
                        <a href="{% url 'cam_igcse:module_detail' m.slug %}" 
                           class="px-3 py-2 rounded-md {% if module and m.slug == module.slug %}active{% endif %}">
                           {{ m.name }}
                        </a>
                        {% if m.topics %}
                            <ul class="dropdown hidden absolute top-full left-0 mt-1 bg-white shadow-lg rounded-md min-w-[200px] z-30 group-hover:flex flex-col">
                                {% for topic in m.topics %}
                                    <li>
                                        <a href="{% url 'cam_igcse:topic_detail' m.slug topic.slug %}" class="px-4 py-2 hover:bg-blue-500 hover:text-white {% if topic.slug == request.resolver_match.kwargs.topic_slug %}font-bold{% endif %}">
                                            {{ topic.title }}
                                        </a>
                                    </li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        </div>
    </nav>

    <!-- Mobile menu -->
    <ul class="mobile-nav-links flex flex-col hidden bg-white w-full p-4 space-y-2 md:hidden">
        {% for m in all_modules %}
            <li>
                <a href="{% url 'cam_igcse:module_detail' m.slug %}" class="block px-3 py-2 {% if module and m.slug == module.slug %}font-bold text-blue-700{% endif %}">
                    {{ m.name }}
                </a>
            </li>
        {% endfor %}
    </ul>

    <!-- ---------------- Main Content ---------------- -->
    <main id="igcse-main-dashboard" class="py-6">
        <div class="container mx-auto">
            {% block content %}{% endblock %}
        </div>
    </main>

    <!-- ---------------- JS ---------------- -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const burger = document.querySelector(".burger");
            const mobileMenu = document.querySelector(".mobile-nav-links");
            burger.addEventListener("click", () => {
                mobileMenu.classList.toggle("hidden");
            });
        });
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>
