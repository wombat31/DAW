<!-- templates/learning/module_detail.html -->

{% extends "learning/learning_base.html" %}
{% load static %}

{% block title %}{{ module.name }} | IGCSE Learning{% endblock %}

{% block content %}

<!-- Module header -->
<section class="module-header mb-6">
    <h1 class="text-2xl font-bold mb-2">{{ module.name }}</h1>
    <p class="text-gray-700">{{ module.description }}</p>
</section>

<!-- Topics navigation -->
<section class="module-topics mb-6">
    <h2 class="text-xl font-semibold mb-2">Topics</h2>
    <ul class="flex flex-col space-y-2">
        {% for topic in module.topics %}
            <li>
                <a href="{% url 'cam_igcse:topic_detail' module.slug topic.slug %}"
                   class="text-gray-800 hover:text-blue-700 {% if topic.slug == request.resolver_match.kwargs.topic_slug %}font-semibold underline{% endif %}">
                    {{ topic.title }}
                    {% if topic.is_free %}
                        <span class="text-green-600 ml-1">(Free)</span>
                    {% endif %}
                </a>
            </li>
        {% endfor %}
    </ul>
</section>

<!-- Module content -->
<section class="module-content space-y-6">
    {% for topic in module.topics %}
        <div class="topic-card p-4 border rounded-md shadow-sm">
            <h3 class="text-lg font-semibold mb-1">{{ topic.title }}</h3>
            <p class="text-gray-700 mb-2">{{ topic.short_description }}</p>

            <div class="objectives mb-2">
                <h4 class="font-semibold">Objectives:</h4>
                <ul class="list-disc ml-5">
                    {% for obj in topic.objectives %}
                        <li>{{ obj }}</li>
                    {% endfor %}
                </ul>
            </div>

            <div class="tasks mb-2">
                <h4 class="font-semibold">Collaborative Tasks:</h4>
                {{ topic.collaborative_tasks|safe }}

                <h4 class="font-semibold mt-2">Solo Tasks:</h4>
                {{ topic.solo_tasks|safe }}
            </div>

            <div class="reflection mb-2">
                <h4 class="font-semibold">Reflection / Tips:</h4>
                {{ topic.reflection|safe }}
            </div>

            <div class="downloads mb-2">
                {% if topic.downloads %}
                    <h4 class="font-semibold">Downloads:</h4>
                    <ul class="list-disc ml-5">
                        {% for d in topic.downloads %}
                            <li><a href="{{ d.url }}" class="text-blue-700 hover:underline">{{ d.name }}</a></li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>

            <div class="personalisation mb-2">
                <h4 class="font-semibold">Personalisation:</h4>
                <p><strong>Secure:</strong> {{ topic.personalisation.secure|safe }}</p>
                <p><strong>Foundation:</strong> {{ topic.personalisation.foundation|safe }}</p>
                <p><strong>Support:</strong> {{ topic.personalisation.support|safe }}</p>
            </div>

            <div class="presentation mb-2">
                <h4 class="font-semibold">Presentation / Slides:</h4>
                {{ topic.presentation|safe }}
            </div>

            <div class="spark-question mb-2">
                <h4 class="font-semibold">Spark Question:</h4>
                <p>{{ topic.spark_question }}</p>
            </div>
        </div>
    {% endfor %}
</section>

{% endblock %}
